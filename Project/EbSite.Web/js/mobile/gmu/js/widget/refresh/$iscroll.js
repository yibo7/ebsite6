(function(b,a,c){b.Refresh.register("iscroll",{_init:function(){var g=this,f=g._options,d=g.$el,e=d.height();a.extend(f,{useTransition:true,speedScale:1,topOffset:f["$upElem"]?f["$upElem"].height():0});f.threshold=f.threshold||5;d.wrapAll(a('<div class="ui-refresh-wrapper"></div>').height(e)).css("height","auto");g.on("ready",function(){g._loadIscroll()})},_changeStyle:function(d,h){var f=this,e=f._options,g=e.refreshInfo[d];f.origin(d,h);switch(h){case"loaded":g["$icon"].addClass("ui-refresh-icon");break;case"beforeload":g["$label"].html("\u677e\u5f00\u7acb\u5373\u52a0\u8f7d");g["$icon"].addClass("ui-refresh-flip");break;case"loading":g["$icon"].removeClass().addClass("ui-loading");break}return f},_loadIscroll:function(){var f=this,e=f._options,d=e.threshold;e.iScroll=new iScroll(f.$el.parent().get(0),e.iScrollOpts=a.extend({useTransition:e.useTransition,speedScale:e.speedScale,topOffset:e.topOffset},e.iScrollOpts,{onScrollStart:function(g){f.trigger("scrollstart",g)},onScrollMove:(function(){var g=e.$upElem&&e.$upElem.length,h=e.$downElem&&e.$downElem.length;return function(m){var i=e._upRefreshed,j=e._downRefreshed,l=f._status("up"),k=f._status("down");if(g&&!l||h&&!k||this.maxScrollY>=0){return}if(k&&h&&!j&&this.y<(this.maxScrollY-d)){f._setMoveState("down","beforeload","pull")}else{if(l&&g&&!i&&this.y>d){f._setMoveState("up","beforeload","pull");this.minScrollY=0}else{if(k&&j&&this.y>(this.maxScrollY+d)){f._setMoveState("down","loaded","restore")}else{if(l&&i&&this.y<d){f._setMoveState("up","loaded","restore");this.minScrollY=-e.topOffset}}}}f.trigger("scrollmove",m)}})(),onScrollEnd:function(h){var g=e._actDir;if(g&&f._status(g)){f._setStyle(g,"loading");f._loadingAction(g,"pull")}f.trigger("scrollend",h)}}))},_setMoveState:function(d,h,g){var f=this,e=f._options;f._setStyle(d,h);e["_"+d+"Refreshed"]=g=="pull";e._actDir=g=="pull"?d:"";return f},afterDataLoading:function(d){var f=this,e=f._options,d=d||e._actDir;e.iScroll.refresh();e["_"+d+"Refreshed"]=false;return f.origin(d)}})})(gmu,gmu.$);