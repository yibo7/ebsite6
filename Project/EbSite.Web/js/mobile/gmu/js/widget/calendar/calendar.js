(function(e,f,d){var g=["01\u6708","02\u6708","03\u6708","04\u6708","05\u6708","06\u6708","07\u6708","08\u6708","09\u6708","10\u6708","11\u6708","12\u6708"],b=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],k=/^(\+|\-)?(\d+)(M|Y)$/i,c=function(l,m){return 32-new Date(l,m,32).getDate()},h=function(l,m){return new Date(l,m,1).getDay()},a=function(n,l){var m=""+n;while(m.length<l){m="0"+m}return m},j=function(l){return l.is("select, input")?l.val():l.attr("data-value")},i;e.define("Calendar",{options:{date:null,firstDay:1,maxDate:null,minDate:null,swipeable:false,monthChangeable:false,yearChangeable:false},_init:function(){this.on("ready",function(){var n=this._options,m=this._container||this.$el,l=f.proxy(this._eventHandler,this);this.minDate(n.minDate).maxDate(n.maxDate).date(n.date||new Date()).refresh();m.addClass("ui-calendar").on("click",l).highlight();n.swipeable&&m.on("swipeLeft swipeRight",l)})},_create:function(){var l=this.$el;if(!l){l=this.$el=f("<div>")}l.appendTo(this._options.container||(l.parent().length?"":document.body))},_eventHandler:function(s){var q=this._options,m=(this._container||this.$el).get(0),p,r,l,o,n;switch(s.type){case"swipeLeft":case"swipeRight":return this.switchMonthTo((s.type=="swipeRight"?"-":"+")+"1M");case"change":n=f(".ui-calendar-header .ui-calendar-year, .ui-calendar-header .ui-calendar-month",this._el);return this.switchMonthTo(j(n.eq(1)),j(n.eq(0)));default:r=s.target;if((p=f(r).closest(".ui-calendar-calendar tbody a",m))&&p.length){s.preventDefault();l=p.parent();this._option("selectedDate",o=new Date(l.attr("data-year"),l.attr("data-month"),p.text()));this.trigger("select",o,f.calendar.formatDate(o),this);this.refresh()}else{if((p=f(r).closest(".ui-calendar-prev, .ui-calendar-next",m))&&p.length){s.preventDefault();this.switchMonthTo((p.is(".ui-calendar-prev")?"-":"+")+"1M")}}}},_option:function(m,q){var n=this._options,l,o,p;if(q!==d){switch(m){case"minDate":case"maxDate":n[m]=q?f.calendar.parseDate(q):null;break;case"selectedDate":o=n.minDate;p=n.maxDate;q=f.calendar.parseDate(q);q=o&&o>q?o:p&&p<q?p:q;n._selectedYear=n._drawYear=q.getFullYear();n._selectedMonth=n._drawMonth=q.getMonth();n._selectedDay=q.getDate();break;case"date":this._option("selectedDate",q);n[m]=this._option("selectedDate");break;default:n[m]=q}n._invalid=true;return this}return m=="selectedDate"?new Date(n._selectedYear,n._selectedMonth,n._selectedDay):n[m]},switchToToday:function(){var l=new Date();return this.switchMonthTo(l.getMonth(),l.getFullYear())},switchMonthTo:function(p,m){var n=this._options,o=this.minDate(),s=this.maxDate(),r,q,l;if(Object.prototype.toString.call(p)==="[object String]"&&k.test(p)){r=RegExp.$1=="-"?-parseInt(RegExp.$2,10):parseInt(RegExp.$2,10);q=RegExp.$3.toLowerCase();p=n._drawMonth+(q=="m"?r:0);m=n._drawYear+(q=="y"?r:0)}else{p=parseInt(p,10);m=parseInt(m,10)}l=new Date(m,p,1);l=o&&o>l?o:s&&s<l?s:l;p=l.getMonth();m=l.getFullYear();if(p!=n._drawMonth||m!=n._drawYear){this.trigger("monthchange",n._drawMonth=p,n._drawYear=m,this);n._invalid=true;this.refresh()}return this},refresh:function(){var n=this._options,m=this._container||this.$el,l=f.proxy(this._eventHandler,this);if(!n._invalid){return}f(".ui-calendar-calendar td:not(.ui-state-disabled), .ui-calendar-header a",m).highlight();f(".ui-calendar-header select",m).off("change",l);m.empty().append(this._generateHTML());f(".ui-calendar-calendar td:not(.ui-state-disabled), .ui-calendar-header a",m).highlight("ui-state-hover");f(".ui-calendar-header select",m).on("change",l);n._invalid=false;return this},destroy:function(){var m=this._container||this.$el,l=this._eventHandler;f(".ui-calendar-calendar td:not(.ui-state-disabled)",m).highlight();f(".ui-calendar-header select",m).off("change",l);m.remove();return this.$super("destroy")},_generateHTML:function(){var l=this._options,r=l._drawYear,v=l._drawMonth,q=new Date(),z=new Date(q.getFullYear(),q.getMonth(),q.getDate()),t=this.minDate(),o=this.maxDate(),x=this.selectedDate(),w="",u,s,n,A,y,m,B,p;n=(isNaN(n=parseInt(l.firstDay,10))?0:n);w+=this._renderHead(l,r,v,t,o)+'<table  class="ui-calendar-calendar"><thead><tr>';for(u=0;u<7;u++){A=(u+n)%7;w+="<th"+((u+n+6)%7>=5?' class="ui-calendar-week-end"':"")+"><span>"+b[A]+"</span></th>"}w+='</thead></tr><tbody><tr class="ui-calendar-gap"><td colspan="7">&#xa0;</td></tr>';m=c(r,v);y=(h(r,v)-n+7)%7;B=Math.ceil((y+m)/7);p=new Date(r,v,1-y);for(u=0;u<B;u++){w+="<tr>";for(s=0;s<7;s++){w+=this._renderDay(s,p,n,v,x,z,t,o);p.setDate(p.getDate()+1)}w+="</tr>"}w+="</tbody></table>";return w},_renderHead:function(q,n,r,o,l){var s='<div class="ui-calendar-header">',m=new Date(n,r,-1),t=new Date(n,r+1,1),p,u;s+='<a class="ui-calendar-prev'+(o&&o>m?" ui-state-disable":"")+'" href="#">&lt;&lt;</a><div class="ui-calendar-title">';if(q.yearChangeable){s+='<select class="ui-calendar-year">';for(p=Math.max(1970,n-10),u=p+20;p<u;p++){s+='<option value="'+p+'" '+(p==n?'selected="selected"':"")+">"+p+"\u5e74</option>"}s+="</select>"}else{s+='<span class="ui-calendar-year" data-value="'+n+'">'+n+"\u5e74</span>"}if(q.monthChangeable){s+='<select class="ui-calendar-month">';for(p=0;p<12;p++){s+='<option value="'+p+'" '+(p==r?'selected="selected"':"")+">"+g[p]+"</option>"}s+="</select>"}else{s+='<span class="ui-calendar-month" data-value="'+r+'">'+g[r]+"</span>"}s+='</div><a class="ui-calendar-next'+(l&&l<t?" ui-state-disable":"")+'" href="#">&gt;&gt;</a></div>';return s},_renderDay:function(r,o,m,s,t,u,q,l){var n=(o.getMonth()!==s),p;p=n||(q&&o<q)||(l&&o>l);return"<td class='"+((r+m+6)%7>=5?"ui-calendar-week-end":"")+(p?" ui-calendar-unSelectable ui-state-disabled":"")+(n||p?"":(o.getTime()===t.getTime()?" ui-calendar-current-day":"")+(o.getTime()===u.getTime()?" ui-calendar-today":""))+"'"+(p?"":" data-month='"+o.getMonth()+"' data-year='"+o.getFullYear()+"'")+">"+(n?"&#xa0;":(p?"<span class='ui-state-default'>"+o.getDate()+"</span>":"<a class='ui-state-default"+(o.getTime()===u.getTime()?" ui-state-highlight":"")+(o.getTime()===t.getTime()?" ui-state-active":"")+"' href='#'>"+o.getDate()+"</a>"))+"</td>"}});i=e.Calendar.prototype;f.each(["maxDate","minDate","date","selectedDate"],function(m,l){i[l]=function(n){return this._option(l,n)}});f.calendar={parseDate:function(m){var l=/^(\d{4})(?:\-|\/)(\d{1,2})(?:\-|\/)(\d{1,2})$/;return Object.prototype.toString.call(m)==="[object Date]"?m:l.test(m)?new Date(parseInt(RegExp.$1,10),parseInt(RegExp.$2,10)-1,parseInt(RegExp.$3,10)):null},formatDate:function(l){return l.getFullYear()+"-"+a(l.getMonth()+1,2)+"-"+a(l.getDate(),2)}}})(gmu,gmu.$);