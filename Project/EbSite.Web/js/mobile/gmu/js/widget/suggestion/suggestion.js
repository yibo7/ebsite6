(function(b,c){var a=0;gmu.define("Suggestion",{options:{historyShare:true,confirmClearHistory:true,autoClose:false},template:{wrapper:'<div class="ui-suggestion"><div class="ui-suggestion-content"></div><div class="ui-suggestion-button"><span class="ui-suggestion-clear">\u6e05\u9664\u5386\u53f2\u8bb0\u5f55</span><span class="ui-suggestion-close">\u5173\u95ed</span></div></div>'},_initDom:function(){var d=this,f=d.getEl().attr("autocomplete","off"),e=f.parent(".ui-suggestion-mask");e.length?d.$mask=e:f.wrap(d.$mask=b('<div class="ui-suggestion-mask"></div>'));d.$mask.append(d.tpl2html("wrapper"));d.$wrapper=d.$mask.find(".ui-suggestion").prop("id","ui-suggestion-"+(a++));d.$content=d.$wrapper.css("top",f.height()+(d.wrapperTop=parseInt(d.$wrapper.css("top"),10)||0)).find(".ui-suggestion-content");d.$btn=d.$wrapper.find(".ui-suggestion-button");d.$clearBtn=d.$btn.find(".ui-suggestion-clear");d.$closeBtn=d.$btn.find(".ui-suggestion-close");return d.trigger("initdom")},_bindEvent:function(){var f=this,d=f.getEl(),e=f.eventNs;f._options.autoClose&&b(document).on("tap"+e,function(g){!b.contains(f.$mask.get(0),g.target)&&f.hide()});d.on("focus"+e,function(){!f.isShow&&f._showList().trigger("open")});d.on("input"+e,function(){f._showList()});f.$clearBtn.on("click"+e,function(){f.history(null)}).highlight("ui-suggestion-highlight");f.$closeBtn.on("click"+e,function(){f.getEl().blur();f.hide().trigger("close")}).highlight("ui-suggestion-highlight");return f},_create:function(){var f=this,e=f._options,d=e.historyShare;e.container&&(f.$el=b(e.container));f.key=d?((b.type(d)==="boolean"?"":d+"-")+"SUG-Sharing-History"):f.getEl().attr("id")||("ui-suggestion-"+(a++));f.separator=encodeURIComponent(",");f._initDom()._bindEvent();return f},_showList:function(){var d=this,f=d.value(),e;if(f){d.trigger("sendrequest",f,b.proxy(d._render,d),b.proxy(d._cacheData,d))}else{(e=d._localStorage())?d._render(f,e.split(d.separator)):d.hide()}return d},_render:function(e,d){this.trigger("renderlist",d,e,b.proxy(this._fillWrapper,this))},_fillWrapper:function(d){this.$clearBtn[this.value()?"hide":"show"]();d?(this.$content.html(d),this.show()):this.hide();return this},_localStorage:function(i){var g=this,f=g.key,j=g.separator,d,h;try{d=c.localStorage;if(i===undefined){return d[f]}else{if(i===null){d[f]=""}else{if(i){h=d[f]?d[f].split(j):[];if(!~b.inArray(i,h)){h.unshift(i);d[f]=h.join(j)}}}}}catch(e){console.log(e.message)}return g},_cacheData:function(d,e){this.cacheData||(this.cacheData={});return e!==undefined?this.cacheData[d]=e:this.cacheData[d]},value:function(){return this.getEl().val()},history:function(e){var d=this,f=e!==null||function(){return d._localStorage(null).hide()};return e===null?(d._options.confirmClearHistory?c.confirm("\u6e05\u9664\u5168\u90e8\u67e5\u8be2\u5386\u53f2\u8bb0\u5f55\uff1f")&&f():f()):d._localStorage(e)},show:function(){if(!this.isShow){this.$wrapper.show();this.isShow=true;return this.trigger("show")}else{return this}},hide:function(){if(this.isShow){this.$wrapper.hide();this.isShow=false;return this.trigger("hide")}else{return this}},destroy:function(){var f=this,d=f.getEl(),e=f.ns;f.trigger("destroy");d.off(e);f.$mask.replaceWith(d);f.$clearBtn.off(e);f.$closeBtn.off(e);f.$wrapper.children().off().remove();f.$wrapper.remove();f._options.autoClose&&b(document).off(e);this.destroyed=true;return f}})})(gmu.$,window);