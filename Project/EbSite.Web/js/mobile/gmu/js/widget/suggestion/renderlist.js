(function(a){a.extend(gmu.Suggestion.options,{isHistory:true,usePlus:false,listCount:5,renderlist:null});gmu.Suggestion.option("renderlist",function(){return a.type(this._options.renderlist)!=="function"},function(){var d=this,b=a("<div></div>"),c=function(f){return b.text(f).html()},e=function(m,h){var l=d._options,k=[],n="",g,f,j;if(!h||!h.length){d.hide();return k}h=h.slice(0,l.listCount);m=c(m||"");for(j=0,f=h.length;j<f;j++){n=c(g=h[j]);m&&(n=a.trim(g).replace(m,"<span>"+m+"</span>"));l.usePlus&&(n+='<div class="ui-suggestion-plus" data-item="'+g+'"></div>');k.push("<li>"+n+"</li>")}return k};d.on("ready",function(){var h=this,g=h.eventNs,f=a(h._options.form||h.getEl().closest("form"));f.size()&&(h.$form=f.on("submit"+g,function(j){var i=gmu.Event("submit");h._options.isHistory&&h._localStorage(h.value());h.trigger(i);i.isDefaultPrevented()&&j.preventDefault()}));h.$content.on("touchstart"+g,function(i){i.preventDefault()});h.$content.on("tap"+g,function(j){var k=h.getEl(),i=a(j.target);if(i.hasClass("ui-suggestion-plus")){k.val(i.attr("data-item"))}else{if(a.contains(h.$content.get(0),i.get(0))){setTimeout(function(){k.val(i.text());h.trigger("select",i).hide().$form.submit()},400)}}}).highlight("ui-suggestion-highlight");h.on("destroy",function(){f.size()&&f.off(g);h.$content.off()})});d.on("renderlist",function(i,h,g,j){var f=e(g,h);return j(f.length?"<ul>"+f.join(" ")+"</ul>":"")})})})(gmu.$);